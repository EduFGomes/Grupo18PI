import getpass
import oracledb

#pw = getpass.getpass("Enter password: ")

try:
    conexao = oracledb.connect(
    user = "BD150224132",
    password = "Crcud6",
    dsn = "BD-ACD/xe")
except Exception as erro:
    print("Erro em conex√£o", erro)
else:
    print("Conectado", conexao.version)

cursor = conexao.cursor()

cursor.execute("""
    create table tabela_produtos(
    codigo_prod number (10) not null,
    nome varchar2 (30) not null,
    descricao varchar2 (50),
    custo_prod float (5) not null,
    custo_fixo float (5) not null,
    comissao_venda float (5) not null,
    impostos float (5) not null,
    rentabilidade float (5),
    constraint codigo_prod primary key (codigo_prod)
    )""")

cursor.execute("""
    insert into tabela_produtos 
    (codigo_prod, nome, descricao, custo_prod, custo_fixo, comissao_venda, impostos, rentabilidade) 
    values 
    (01, 'Arroz', 'Arroz Branco Camil 5Kg', 20, 10, 5, 18, 40)
""")

cursor.execute("select * from tabela_produtos")
resultado = cursor.fetchall()

conexao.commit()
